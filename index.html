// ... (The promos array remains the same) ...

// --- 2. DOM ELEMENT SELECTORS ---
const featuredVideoContainer = document.querySelector('.featured-video-container');
const promoListContainer = document.querySelector('.promo-list-container');
const searchInput = document.getElementById('searchInput'); // NEW
const searchButton = document.getElementById('searchButton'); // NEW

// --- 3. CORE FUNCTIONS ---

// ... (loadFeaturedVideo and createPromoCard functions remain the same) ...


/**
 * Renders the entire list of promos, optionally filtering them.
 * @param {Array} filteredPromos - The list of promos to display (defaults to the full list).
 */
function renderPromoList(filteredPromos = promos) { // Function updated to accept a filter
    // Generate the HTML for filtered cards
    const cardHtml = filteredPromos.map(createPromoCard).join('');
    promoListContainer.innerHTML = cardHtml;

    // ... (rest of the click listener setup remains the same) ...
    const newPromoCards = document.querySelectorAll('.promo-card');
    
    newPromoCards.forEach(card => {
        card.addEventListener('click', () => {
            const url = card.getAttribute('data-embed-url');
            loadFeaturedVideo(url);
            
            // Highlight the clicked card
            newPromoCards.forEach(c => c.classList.remove('active-promo'));
            card.classList.add('active-promo');
        });
    });
    
    // Highlight the first card of the *filtered* list by default
    if (newPromoCards.length > 0) {
        loadFeaturedVideo(filteredPromos[0].embedUrl); // Load the first video of the filtered list
        newPromoCards[0].classList.add('active-promo');
    } else {
        // Clear video if no results found
        featuredVideoContainer.innerHTML = '<p style="color: var(--text-muted); padding: 50px;">No promos match your search.</p>';
    }
}


/**
 * Executes the search logic and re-renders the promo list.
 */
function handleSearch() {
    const query = searchInput.value.trim().toLowerCase();
    
    // If the search box is empty, show the full list
    if (query === '') {
        renderPromoList(promos);
        return;
    }

    // Filter the promos array based on the query
    const results = promos.filter(promo => {
        const titleMatch = promo.title.toLowerCase().includes(query);
        const descriptionMatch = promo.description.toLowerCase().includes(query);
        
        return titleMatch || descriptionMatch;
    });

    renderPromoList(results);
}


// --- 4. INITIALIZATION AND EVENT LISTENERS ---

document.addEventListener('DOMContentLoaded', () => {
    // Initial rendering of the full list
    renderPromoList(promos); 

    // Add event listener for the Search button
    searchButton.addEventListener('click', handleSearch);

    // Allow search on Enter key press in the input field
    searchInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            handleSearch();
        }
    });

    // You mentioned opening a URL when clicking 'Start'. 
    // Since your app *is* the URL, we'll assume the 'Home' button acts as 'Start'.
    // The "Home" button is already active, leading to this page.
});

// Note: Removed initial loadFeaturedVideo(promos[0].embedUrl) from the bottom 
// because renderPromoList now handles the initial load of the first video in the list.
